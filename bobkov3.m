function [chf] = bobkov3(g,x,p)
% (c) 2023, Saad Islam AMEI
% Dept. of Nuclear Engineering, University of Dhaka
%
% LUT based on:  
% Bobkov, V. P., et al. "A modified table for calculating critical heat 
% fluxes in assemblies of triangularly packed fuel rods." Thermal 
% engineering 58 (2011): 317-324.
%
% Input: 
% ------
% bobkov3(g,x,p)
%
% Where, 
% g: mass flux, G (kg/m2s)
% x: thermodynamic equilibrium quality, xe
% p: pressure, P (kPa)
% 
% Output: 
% -------
% chf: crtitical heat flux, CHF (kW/m2)

% Todo:
% -----
% interpolate and fill-in the missing (nan) values

xdata=[-0.5,-0.4,-0.3,-0.2,-0.1,0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1];
gdata=[25,50,100,200,300,500,750,1000,1500,2000,3000,4000,5000];
pdata=[100,200,400,600,1000,2000,3000,5000,6000,8000,10000,12000,14000,16000,18000,20000];

lut(:,:,1)=[nan,nan,nan,370,140,72,70,70,68,67,67,53,49,46,43,42;
nan,nan,nan,596,227,118,114,113,111,110,109,89,68,68,68,68;
nan,nan,nan,661,304,189,196,205,215,221,214,174,134,132,132,132;
nan,nan,nan,937,519,324,334,343,342,323,299,243,200,185,189,nan;
nan,nan,nan,1418,910,573,587,590,569,504,450,365,321,nan,nan,nan;
nan,nan,nan,1930,1386,859,911,898,884,846,716,479,nan,nan,nan,nan;
nan,nan,nan,2188,1601,1038,1084,1061,981,977,nan,nan,nan,nan,nan,nan;
nan,nan,nan,2416,1795,1210,1249,1213,1061,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,2813,2093,1462,1472,1418,1358,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,3181,2377,1689,1689,1588,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,3951,2981,2196,2163,nan,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,4963,3687,2799,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,6307,4481,3525,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan];

lut(:,:,2)=[nan,nan,nan,357,162,100,77,72,72,73,69,57,47,46,46,45;
nan,nan,nan,575,263,164,126,117,117,119,114,93,76,74,72,70;
nan,nan,nan,645,336,212,200,209,216,216,212,179,142,132,133,116;
nan,nan,nan,925,563,358,351,357,350,331,309,251,208,188,190,160;
nan,nan,nan,1417,975,620,632,627,597,541,480,376,323,292,288,227;
nan,nan,nan,1930,1476,951,976,940,868,806,678,462,364,327,nan,nan;
nan,nan,nan,2180,1696,1128,1136,1092,964,921,780,505,nan,nan,nan,nan;
nan,nan,nan,2396,1895,1298,1287,1230,1045,1022,870,nan,nan,nan,nan,nan;
nan,nan,nan,2773,2187,1540,1494,1425,1282,1237,nan,nan,nan,nan,nan,nan;
nan,nan,nan,3140,2479,1768,1709,1613,1448,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,3926,3102,2266,2165,1893,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,5089,3816,2856,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,6518,4600,3518,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan];

lut(:,:,3)=[nan,nan,nan,336,194,135,94,83,78,76,70,60,56,55,53,50;
nan,nan,nan,541,312,217,154,133,128,125,113,95,90,86,84,80;
nan,nan,nan,626,389,242,226,229,231,223,215,196,166,150,150,120;
nan,nan,nan,921,644,425,411,403,371,344,313,276,237,213,208,153;
nan,nan,nan,1447,1105,759,757,727,625,561,486,411,360,320,311,217;
nan,nan,nan,1974,1627,1144,1114,1036,861,726,566,434,356,319,308,nan;
nan,nan,nan,2218,2156,1310,1255,1170,951,803,619,437,nan,nan,nan,nan;
nan,nan,nan,2426,2068,1461,1375,1287,1023,863,659,nan,nan,nan,nan,nan;
nan,nan,nan,2786,2369,1685,1659,1514,1153,937,nan,nan,nan,nan,nan,nan;
nan,nan,nan,3161,2681,1919,1919,1719,1242,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,4008,3339,2510,2486,2008,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,5311,4089,3024,2954,nan,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,nan,6863,4854,3508,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan];

lut(:,:,4)=[nan,nan,449,325,210,148,107,93,88,84,70,63,63,62,61,54;
nan,nan,721,524,337,240,174,150,143,135,116,102,101,98,96,95;
nan,nan,833,621,431,266,261,259,256,238,218,211,189,168,162,137;
nan,nan,1210,944,729,505,487,458,389,350,306,293,267,237,225,158;
nan,nan,1874,1522,1275,947,909,824,630,547,461,437,404,357,333,192;
nan,nan,2500,2078,1823,1383,1278,1154,873,684,485,410,359,317,310,238;
nan,nan,2733,2318,2056,1538,1413,1258,942,735,524,402,328,290,nan,nan;
nan,nan,2915,2519,2255,1668,1519,1337,994,767,550,379,282,nan,nan,nan;
nan,nan,3322,2890,2579,1888,1840,1577,1027,745,nan,nan,nan,nan,nan,nan;
nan,nan,3773,3280,2914,2104,2130,1770,1076,nan,nan,nan,nan,nan,nan,nan;
nan,nan,5024,4169,3603,2732,2781,2036,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,6921,5428,4379,3199,3252,nan,nan,nan,nan,nan,nan,nan,nan,nan;
nan,nan,9218,6946,5005,3564,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan];

lut(:,:,5)=[nan,448,387,310,232,171,130,112,103,96,84,84,83,76,74,50;
nan,721,622,499,373,275,210,182,167,155,133,133,132,123,119,81;
nan,819,731,619,494,328,318,306,288,255,208,216,217,190,178,88;
nan,1184,1106,995,885,658,611,529,414,355,294,301,298,262,242,122;
nan,1824,1775,1680,1606,1279,1156,938,631,529,443,446,435,381,348,168;
nan,2437,2398,2306,2263,1840,1596,1388,883,676,447,377,366,322,302,187;
nan,2662,2618,2521,2463,1997,1733,1404,911,707,468,352,316,279,262,185;
nan,2835,2787,2685,2616,2110,1836,1374,913,717,476,311,249,220,211,177;
nan,3273,3173,3073,2969,2336,1999,1544,787,501,nan,nan,nan,nan,nan,nan;
nan,3926,3627,3497,3350,2482,2251,1691,nan,nan,nan,nan,nan,nan,nan,nan;
nan,5761,4834,4381,4102,2917,2779,nan,nan,nan,nan,nan,nan,nan,nan,nan;
nan,8037,6633,5484,4864,3442,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan;
nan,10688,8783,6737,5049,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan,nan];

lut(:,:,6)=[369,344,303,259,207,153,118,104,95,89,86,87,91,81,74,38;
594,553,488,415,333,247,192,167,154,143,138,140,146,130,123,62;
667,630,575,511,433,293,283,276,263,243,220,213,196,172,158,95;
953,918,872,815,751,567,533,491,398,372,338,312,270,236,215,111;
1449,1422,1403,1366,1334,1079,996,886,639,602,549,462,396,344,311,130;
1949,1923,1906,1868,1861,1620,1403,1256,875,814,651,482,396,344,311,148;
2143,2107,2085,2041,2023,1754,1528,1278,908,811,627,445,350,300,273,152;
2295,2248,2220,2173,2142,1850,1620,1257,916,783,576,385,282,244,221,134;
2789,2605,2536,2481,2424,2047,1702,1348,866,573,390,248,218,184,167,122;
3613,3153,2894,2816,2714,2131,1811,1438,841,468,294,193,nan,nan,nan,nan;
5570,4735,3946,3527,3297,2412,2136,1571,759,444,nan,nan,nan,nan,nan,nan;
7625,6610,5549,4473,3896,2785,2577,1700,nan,nan,nan,nan,nan,nan,nan,nan;
10011,8748,7415,5692,4074,3061,2847,nan,nan,nan,nan,nan,nan,nan,nan,nan];

lut(:,:,7)=[340,310,278,251,215,159,126,110,105,100,99,98,97,93,89,48;
547,498,448,404,346,256,203,177,162,152,158,164,172,152,142,70;
616,570,530,494,440,306,295,290,276,263,257,239,207,181,164,100;
889,844,815,790,749,580,548,526,443,432,416,350,287,250,226,95;
1367,1329,1327,1326,1319,1091,1017,967,744,741,709,548,424,367,330,134;
1876,1856,1841,1826,1787,1614,1445,1319,1078,977,827,648,488,418,374,158;
2092,2073,2050,2027,1979,1805,1616,1396,1166,982,806,601,441,371,331,165;
2267,2301,2261,2225,2157,1950,1708,1440,1155,941,714,510,362,304,275,162;
2803,2740,2618,2537,2416,2124,1807,1485,1109,796,545,365,273,231,206,115;
3685,3561,3247,3015,2763,2317,1925,1529,1051,669,415,277,195,162,141,nan;
5758,5107,4405,3814,3269,2616,2141,1605,1011,630,419,276,155,129,nan,nan;
7964,7082,6068,4933,3888,2998,2474,1748,1127,819,570,369,184,nan,nan,nan;
10534,9408,8206,6339,4360,3306,2961,1842,1303,1086,753,483,nan,nan,nan,nan];

lut(:,:,8)=[340,313,291,269,240,182,148,131,120,112,114,119,82,74,71,47;
546,504,467,433,387,294,240,211,194,179,183,192,134,120,116,67;
628,588,556,526,482,351,336,330,321,303,295,290,252,220,201,78;
929,881,854,829,793,630,597,588,555,512,488,458,375,325,290,134;
1431,1381,1375,1371,1361,1139,1066,1033,875,823,781,659,508,439,391,153;
1998,2005,1982,1961,1907,1738,1625,1498,1371,1195,1044,835,636,541,479,180;
2278,2288,2251,2210,2137,1984,1801,1676,1458,1277,1038,797,580,486,425,164;
2515,2587,2524,2460,2351,2144,1939,1736,1483,1227,944,673,483,399,347,158;
3165,3141,2970,2834,2639,2338,2047,1781,1442,1066,725,500,368,315,283,155;
4203,4161,3770,3423,3029,2525,2137,1785,1310,858,540,366,273,231,222,111;
6558,5925,5138,4361,3557,2805,2290,1791,1200,758,491,336,208,147,122,77;
9003,8087,6952,5589,4190,3170,2580,1896,1270,909,655,430,226,145,111,55;
11755,10521,9199,7090,4611,3415,3096,2042,1420,1251,879,563,234,169,105,34];

lut(:,:,9)=[351,327,306,285,259,195,162,141,127,119,102,86,83,75,71,41;
565,526,493,460,417,315,260,227,207,192,165,139,134,121,118,74;
654,615,584,555,514,375,356,348,340,323,265,242,232,203,184,95;
974,922,893,869,833,667,629,616,593,553,467,425,373,323,289,120;
1538,1466,1447,1433,1417,1216,1139,1120,1065,980,846,768,628,540,473,153;
2199,2164,2109,2062,1987,1842,1679,1613,1471,1327,1126,952,749,646,604,320;
2578,2510,2420,2337,2237,2052,1889,1730,1570,1367,1138,897,673,566,511,274;
2898,2877,2746,2613,2442,2223,2000,1807,1604,1327,1027,748,535,439,377,174;
3697,3537,3273,3030,2733,2370,2114,1887,1548,1167,796,542,395,334,344,171;
4913,4678,4181,3690,3084,2524,2135,1829,1406,913,566,390,287,241,242,154;
7339,6467,5593,4632,3576,2689,2177,1757,1210,758,487,336,219,160,123,103;
9554,8407,7188,5692,4076,2890,2317,1765,1206,862,608,408,229,153,115,74;
11669,10409,8945,6708,4305,2716,2504,1880,1264,1215,812,507,229,166,103,38];

lut(:,:,10)=[415,389,366,346,321,218,185,168,158,149,128,111,107,95,87,41;
666,625,589,558,517,352,296,271,254,240,208,178,172,152,144,76;
772,726,690,662,622,456,422,411,404,392,321,280,283,245,221,82;
1159,1085,1040,1013,973,794,718,700,683,655,531,466,435,376,331,99;
1838,1717,1659,1635,1605,1425,1267,1232,1202,1142,919,808,707,607,529,148;
2645,2508,2395,2305,2224,2030,1868,1706,1575,1355,1125,942,764,671,680,394;
3110,2916,2752,2609,2457,2283,2018,1818,1600,1340,1086,862,656,560,544,442;
3493,3351,3124,2892,2649,2351,2077,1836,1544,1251,941,684,483,395,359,216;
4432,4100,3718,3335,2870,2457,2108,1809,1476,1058,707,467,319,253,169,297;
5748,5316,4706,4017,3229,2526,2105,1753,1302,835,500,327,223,178,134,123;
8074,7004,6065,4956,3639,2644,2071,1622,1140,676,421,285,186,137,108,100;
9753,8494,7310,5772,4036,2700,2037,1566,1059,721,497,335,201,139,106,72;
10797,9690,8409,6405,4238,2259,1808,1513,1016,842,593,372,195,143,91,38];

lut(:,:,11)=[503,475,450,428,402,285,237,213,198,189,168,146,138,120,109,47;
808,764,722,686,646,459,381,342,319,305,271,237,222,195,179,76;
934,883,835,799,760,576,522,501,487,483,405,339,321,279,248,82;
1395,1311,1235,1187,1156,966,841,831,792,743,573,454,426,368,327,88;
2207,2061,1936,1870,1858,1686,1420,1437,1353,1212,856,640,595,512,449,140;
3159,2920,2738,2590,2427,2234,1924,1787,1556,1281,971,762,614,536,484,205;
3691,3366,3118,2883,2668,2375,2106,1811,1516,1164,882,671,503,431,386,192;
4128,3840,3510,3161,2792,2456,2085,1744,1386,1001,724,512,361,297,260,123;
5138,4638,4131,3579,2995,2444,2033,1648,1217,814,534,357,235,189,150,110;
6473,5846,5124,4285,3277,2541,1985,1538,1073,642,398,260,173,137,115,97;
8536,7315,6355,5111,3674,2591,1940,1418,939,556,350,244,160,122,103,80;
9604,8252,7175,5691,3893,2575,1822,1354,916,589,416,282,176,126,92,57;
9564,8616,7649,6038,3640,2065,1332,1320,981,670,525,325,173,128,83,38];

lut(:,:,12)=[588,559,532,507,481,364,295,260,241,233,210,188,172,150,133,42;
942,898,856,814,772,585,475,419,387,377,338,302,276,242,216,77;
1081,1033,982,932,886,705,620,584,569,576,493,372,324,281,250,80;
1595,1514,1431,1358,1299,1096,988,950,896,802,620,480,402,347,309,104;
2499,2358,2216,2101,2022,1799,1653,1618,1486,1186,815,655,516,446,397,223;
3505,3219,3005,2789,2548,2207,1948,1694,1479,1134,825,612,461,395,296,207;
4036,3639,3343,3011,2645,2321,1926,1657,1319,969,685,495,354,299,243,142;
4459,4093,3690,3235,2737,2303,1925,1549,1150,766,524,370,258,216,180,137;
5543,4885,4275,3599,2889,2347,1868,1423,978,591,391,269,189,155,148,133;
6789,5987,5206,4195,3223,2444,1893,1348,864,493,312,227,156,128,117,101;
8389,7120,6146,4908,3517,2567,1855,1281,788,461,311,219,149,118,101,83;
8736,7451,6515,5221,3635,2504,1750,1216,802,506,358,252,162,120,92,63;
7687,6964,6321,5276,3213,1969,1225,1105,839,484,393,295,168,124,81,37];

lut(:,:,13)=[647,623,601,576,552,439,353,304,271,253,233,213,179,157,139,42;
1039,1001,964,925,887,705,568,490,436,406,375,343,290,253,227,78;
1176,1136,1097,1050,1005,825,706,645,586,545,437,352,290,252,226,84;
1690,1631,1573,1504,1441,1253,1089,993,812,701,539,432,342,297,267,101;
2581,2492,2402,2290,2198,2015,1771,1612,1198,951,695,554,413,359,327,152;
3439,3240,3069,2840,2536,2223,1853,1600,1272,975,691,502,366,315,262,179;
3867,3577,3316,2975,2510,2113,1781,1431,1143,815,573,390,282,239,224,163;
4190,3957,3607,3084,2541,2086,1698,1336,974,633,417,295,212,183,173,135;
5384,4686,4087,3366,2639,2125,1686,1258,841,493,314,228,169,146,144,139;
6453,5596,4795,3830,2900,2298,1771,1259,800,443,287,204,150,125,117,120;
7550,6328,5454,4252,3166,2406,1828,1256,786,480,308,217,147,116,102,92;
7084,6131,5386,4360,3185,2393,1763,1228,819,539,368,246,156,115,89,66;
5339,4781,4523,4040,2680,2027,1405,1046,790,574,364,256,152,114,77,40];

lut(:,:,14)=[654,633,614,592,572,489,394,335,273,237,209,175,133,118,109,43;
1051,1017,985,951,919,783,632,539,438,381,335,282,217,191,174,79;
1174,1137,1103,1064,1025,898,767,688,561,495,376,307,237,208,188,86;
1644,1580,1530,1476,1414,1284,1145,1020,803,639,462,369,298,259,236,103;
2455,2344,2264,2184,2081,1953,1810,1603,1225,879,596,465,393,343,316,137;
3178,2868,2714,2527,2255,1950,1694,1400,1128,854,601,433,334,295,264,161;
3460,3075,2864,2566,2172,1817,1493,1224,964,714,488,341,250,222,219,194;
3652,3351,3053,2672,2145,1764,1440,1108,833,549,360,247,187,166,162,159;
4455,3910,3456,2852,2287,1834,1473,1098,760,437,267,192,147,131,140,131;
5018,4583,4015,3223,2533,2044,1639,1208,786,455,268,190,137,119,114,122;
6024,5140,4450,3544,2738,2211,1754,1277,862,522,347,233,152,117,106,94;
5835,4900,4322,3557,2705,2198,1742,1296,890,617,415,277,165,115,86,67;
4467,3805,3717,3417,2199,1909,1498,1163,861,627,407,259,133,102,71,41];

lut(:,:,15)=[573,556,538,522,505,446,358,302,255,237,206,165,132,117,107,44;
920,892,864,838,811,718,575,486,411,382,333,266,214,189,173,81;
989,956,926,894,859,766,623,542,465,445,363,293,253,221,200,101;
1283,1221,1171,1120,1055,947,807,708,602,539,428,343,304,265,241,126;
1771,1663,1576,1491,1373,1240,1117,988,836,692,526,420,385,335,309,158;
1937,1941,1844,1735,1555,1369,1181,1029,869,690,505,375,306,276,254,165;
2102,2035,1901,1741,1503,1273,1108,935,781,599,411,288,221,199,200,174;
2217,2215,2040,1796,1513,1253,1057,882,695,479,310,211,159,142,147,132;
2941,2693,2387,2039,1652,1371,1161,916,673,424,249,168,142,129,131,124;
3548,3216,2834,2342,1907,1585,1333,1055,769,457,280,189,150,125,121,115;
4450,3624,3134,2566,2061,1719,1445,1155,834,567,381,264,161,118,108,99;
4316,3474,3036,2510,2032,1732,1482,1179,887,628,461,328,182,112,92,71;
3349,2851,2607,2222,1672,1573,1349,1159,898,634,485,365,152,106,76,43];

lut(:,:,16)=[445,438,431,422,393,346,306,285,224,178,148,126,103,90,85,45;
716,702,694,678,632,556,492,459,360,286,237,204,167,149,142,83;
796,785,782,766,691,596,518,496,381,289,244,233,215,190,176,90;
951,933,929,915,824,707,581,538,447,341,279,271,256,225,210,150;
1207,1176,938,911,842,728,611,601,555,423,335,332,323,285,265,167;
1160,1192,941,914,859,735,625,605,571,472,314,266,246,221,220,196;
1146,1054,972,908,819,699,623,623,549,419,279,209,178,162,160,159;
1196,1087,978,885,767,653,608,624,518,363,243,153,121,117,111,102;
1631,1478,1327,1176,962,818,836,669,538,396,204,135,110,105,100,98;
1946,1714,1508,1309,1051,878,834,760,651,382,207,136,110,99,96,93;
2016,1732,1551,1306,1014,835,721,748,683,499,348,237,111,96,95,90;
1854,1678,1503,1267,1016,906,934,790,676,545,412,328,144,115,91,60;
1995,1880,1650,1370,1164,1067,1008,893,802,584,452,372,160,119,80,37];

stopp=0;
stopg=0;
stopx=0;

for ppp=2:15
   if (stopp==0&&p<=pdata(ppp))
       pp=ppp;
       stopp=1;
   end
end

for ggg=2:21
   if (stopg==0&&g<=gdata(ggg))
       gg=ggg;
       stopg=1;
   end
end


for xxx=2:23
   if (stopx==0&&x<=xdata(xxx))
       xx=xxx;
       stopx=1;
   end
end

g0p0=lut(gg-1,xx-1,pp-1)+(x-xdata(xx-1))*(lut(gg-1,xx,pp-1)-lut(gg-1,xx-1,pp-1))/(xdata(xx)-xdata(xx-1));
g0p1=lut(gg-1,xx-1,pp)+(x-xdata(xx-1))*(lut(gg-1,xx,pp)-lut(gg-1,xx-1,pp))/(xdata(xx)-xdata(xx-1));
g1p0=lut(gg,xx-1,pp-1)+(x-xdata(xx-1))*(lut(gg,xx,pp-1)-lut(gg,xx-1,pp-1))/(xdata(xx)-xdata(xx-1));
g1p1=lut(gg,xx-1,pp)+(x-xdata(xx-1))*(lut(gg,xx,pp)-lut(gg,xx-1,pp))/(xdata(xx)-xdata(xx-1));
% then interpolating g*/
p0=g0p0+(g-gdata(gg-1))*(g1p0-g0p0)/(gdata(gg)-gdata(gg-1));
p1=g0p1+(g-gdata(gg-1))*(g1p1-g0p1)/(gdata(gg)-gdata(gg-1));
% finally we interpolate p*/
chf=p0+(p-pdata(pp-1))*(p1-p0)/(pdata(pp)-pdata(pp-1));

end